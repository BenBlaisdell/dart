from dart.client.python.dart_client import Dart
from dart.model.dataset import Column, DatasetData, Dataset, DataFormat, FileFormat, DataType, Compression, RowFormat, \
    LoadType

if __name__ == '__main__':
    dart = Dart('localhost', 5000)
    assert isinstance(dart, Dart)

    dataset = dart.save_dataset(Dataset(id='PDUZ8EDNOR', data=(DatasetData(
        name='beacon_native_app_parsed_gzipped_v03',
        table_name='beacon_native_app',
        location='s3://example-bucket/prd/beacon/native_app/v3/dwh-delimited/gzipped',
        load_type=LoadType.INSERT,
        distribution_keys=['created'],
        sort_keys=['created', 'eventtype'],
        hive_compatible_partition_folders=True,
        data_format=DataFormat(
            FileFormat.TEXTFILE,
            RowFormat.DELIMITED,
            delimited_by='\t',
            quoted_by='"',
            escaped_by='\\',
            null_string='NULL',
        ),
        compression=Compression.GZIP,
        partitions=[Column('createdpartition', DataType.STRING)],
        columns=[
            Column('logfileid', DataType.INT),
            Column('linenumber', DataType.INT),
            Column('created', DataType.TIMESTAMP, date_pattern="yyyy-MM-dd HH:mm:ss"),
            Column('remoteip', DataType.VARCHAR, 500),
            Column('useragent', DataType.VARCHAR, 2500),
            Column('eventtype', DataType.VARCHAR, 255),
            Column('appversion', DataType.VARCHAR, 255),
            Column('advertiserid', DataType.VARCHAR, 2048),
            Column('couponsonpage', DataType.INT),
            Column('coupons', DataType.VARCHAR, 10000),
            Column('channel', DataType.VARCHAR, 128),
            Column('geocouponcount', DataType.BIGINT),
            Column('geofence', DataType.VARCHAR, 255),
            Column('geofencetimespent', DataType.NUMERIC, precision=14, scale=5),
            Column('loginstatus', DataType.VARCHAR, 25),
            Column('products', DataType.VARCHAR, 2500),
            Column('session', DataType.VARCHAR, 5000),
            Column('systemname', DataType.VARCHAR, 2500),
            Column('systemversion', DataType.VARCHAR, 2500),
            Column('udid', DataType.VARCHAR, 128),
            Column('userqualifier', DataType.VARCHAR, 64),
            Column('url', DataType.VARCHAR, 5000),
            Column('user_uuid', DataType.VARCHAR, 64),
            Column('userid', DataType.INT),
            Column('searchtype', DataType.VARCHAR, 128),
            Column('searchlistterm', DataType.VARCHAR, 512),
            Column('searchterm', DataType.VARCHAR, 512),
            Column('emailuuid', DataType.VARCHAR, 128),
            Column('userfingerprint', DataType.VARCHAR, 64),
            Column('locationstatus', DataType.VARCHAR, 128),
            Column('pushnotificationstatus', DataType.VARCHAR, 128),
            Column('placement', DataType.VARCHAR, 1024),
            Column('loc', DataType.VARCHAR, 128),
            Column('ppoi0', DataType.VARCHAR, 128),
            Column('ppoi1', DataType.VARCHAR, 128),
            Column('ppoi2', DataType.VARCHAR, 128),
            Column('ppoi3', DataType.VARCHAR, 128),
            Column('ppoi4', DataType.VARCHAR, 128),
            Column('applaunchnotificationtype', DataType.VARCHAR, 128),
            Column('scenarioname', DataType.VARCHAR, 128),
            Column('behaviorname', DataType.VARCHAR, 128),
            Column('coupontype', DataType.VARCHAR, 128),
            Column('couponposition', DataType.VARCHAR, 128),
            Column('hasqsrcontent', DataType.VARCHAR, 128),
            Column('promptname', DataType.VARCHAR, 128),
            Column('locationpermissionchanage', DataType.VARCHAR, 128),
            Column('couponproblemtype', DataType.VARCHAR, 128),
            Column('storetitle', DataType.VARCHAR, 128),
            Column('mallname', DataType.VARCHAR, 128),
            Column('restaurantname', DataType.VARCHAR, 128),
            Column('milesaway', DataType.VARCHAR, 128),
            Column('menuitem', DataType.VARCHAR, 128),
            Column('toolname', DataType.VARCHAR, 128),
            Column('toolaction', DataType.VARCHAR, 128),
            Column('toolstep', DataType.VARCHAR, 128),
            Column('mallposition', DataType.VARCHAR, 128),
            Column('recommendstorename', DataType.VARCHAR, 128),
            Column('recommendstoreposition', DataType.VARCHAR, 128),
            Column('favoritestorename', DataType.VARCHAR, 128),
            Column('favoritestoreaction', DataType.VARCHAR, 128),
            Column('favoritestoreposition', DataType.VARCHAR, 128),
            Column('favoritesiteid', DataType.VARCHAR, 128),
            Column('receivername', DataType.VARCHAR, 128),
            Column('outclickbuttonprompt', DataType.VARCHAR, 128),
            Column('datasource', DataType.VARCHAR, 1024),
            Column('searchresultcount', DataType.VARCHAR, 128),
            Column('searchresultposition', DataType.VARCHAR, 128),
            Column('sharetype', DataType.VARCHAR, 128),
            Column('daysuntilexpiration', DataType.VARCHAR, 128),
            Column('firedate', DataType.VARCHAR, 128),
            Column('settingschangevalue', DataType.VARCHAR, 128),
            Column('settingschangetype', DataType.VARCHAR, 128),
            Column('settingschangelocation', DataType.VARCHAR, 128),
            Column('clickaction', DataType.VARCHAR, 128),
            Column('tnt', DataType.VARCHAR, 128),
            Column('previouspage', DataType.VARCHAR, 2500),
            Column('clickpage', DataType.VARCHAR, 2500),
            Column('launchreason', DataType.VARCHAR, 128),
            Column('taplyticsData', DataType.VARCHAR, 150),
            Column('appCampaign', DataType.VARCHAR, 50),
            Column('accountMethod', DataType.VARCHAR, 60),
            Column('appState', DataType.VARCHAR, 100),
            Column('btStatus', DataType.BOOLEAN),
            Column('btBeaconId', DataType.VARCHAR, 500),
            Column('btBeaconFactoryId', DataType.VARCHAR, 500),
            Column('btBeaconName', DataType.VARCHAR, 500),
            Column('btTimeSpent', DataType.VARCHAR, 50),
            Column('purchaseId', DataType.VARCHAR, 500),
            Column('transactionId', DataType.VARCHAR, 500),
            Column('outclickLink', DataType.VARCHAR, 1000),
            Column('outclickPage', DataType.VARCHAR, 300),
            Column('featuredCouponPosition', DataType.INT),
            Column('commentCount', DataType.INT),
            Column('mallCount', DataType.INT),
            Column('clickCount', DataType.INT),
            Column('merchantName', DataType.VARCHAR, 100),
            Column('merchantPosition', DataType.INT),
            Column('couponUuids', DataType.VARCHAR, 10000),
            Column('favoriteSiteUuid', DataType.VARCHAR, 50),
            Column('deepLinkType', DataType.VARCHAR, 40),
            Column('adUnitUuid', DataType.VARCHAR, 50),
        ],
    ))))
    print 'created dataset: %s' % dataset.id
